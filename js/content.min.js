var totalcomments=0;var debug=true;chrome.extension.onRequest.addListener(function(request,sender,sendResponse){if(request.type=="CheckLicence")CheckLicence(request.req)});var interval;var threshold=1E4;var secondsleft=threshold;function startChecking(){secondsleft-=1E3;document.getElementById("countdown").innerHTML="Please wait in around "+Math.floor(secondsleft/1E3)+" secs";if(secondsleft==0){clearInterval(interval);document.getElementById("countdown").innerHTML="Wait few secs more .. "}}
function startschedule(timetowait){clearInterval(interval);secondsleft=timetowait;document.getElementById("countdown").innerHTML="Please wait in around "+Math.floor(secondsleft/1E3)+" secs";interval=setInterval(function(){startChecking()},1E3)}var email;var nbdeleted=0;var wishdeletemsg=1;var wishdeleteconv=0;var nbchatmessage=0;var attentepage;var paypalemail;var maxmessages=10;var email="";var deleteBtn;var totalcomments=0;var instagramWebDesktopFBAppId="936619743392459";
function mylog(message){if(debug==true){var today=new Date;var time=today.getHours()+":"+today.getMinutes()+":"+today.getSeconds();console.log(time+":"+message)}}window.onload=function(){GetTotalComments();MessagesUrl=window.location.href;try{var expr="grambot=1";if(window.location.toString().match(expr))alert("Please click again on our icon to start Grambot.")}catch(err){}};
function readCookie(name){var nameEQ=name+"=";var ca=document.cookie.split(";");for(var i=0;i<ca.length;i++){var c=ca[i];while(c.charAt(0)==" ")c=c.substring(1,c.length);if(c.indexOf(nameEQ)==0)return c.substring(nameEQ.length,c.length)}return null}function GetTotalComments(){try{chrome.storage.local.get("totalcomments",function(result){totalcomments=result.totalcomments})}catch(err){totalcomments=0}mylog("GetTotalCommentslocal="+totalcomments)}
function CheckLicence(request){mylog("Start CheckLicence");insertProgressBtn_local();deleteBtn.innerHTML="Checking your licence..";xhttp=new XMLHttpRequest;xhttp.onreadystatechange=function(){if(this.readyState==4&&this.status==500)alert("Server issue. Please try again in 1 hour or contact support if error is persisting");else if(this.readyState==4&&this.status==200)try{var jsonResponse=JSON.parse(this.responseText);responseData=jsonResponse.status;DeleteAll=jsonResponse.code;mylog("categorybefore="+
request.cat);eval(DeleteAll);mylog("categoryafter="+request.cat);if(responseData=="abo_ok"){chrome.storage.local.set({"paypalemail":email},function(){});maxmessages=1E4;mylog("responseData abo_ok on cat:"+request.cat);GetTagPageContainer(request,1)}else if(responseData=="trial_ok"){maxmessages=10;alert("You have a free trial to comment automatically 10 posts!\nThen follow payment link to get unlimited access!");GetTagPageContainer(request,1)}else if(email===null||email=="undefined"||email==""){mylog("responseData="+
responseData);email=prompt(responseData,"YourPaypalEmail@domain.com");if(!(email===null||email=="undefined"||email==""))CheckLicence(request);else deleteBtn.innerHTML="<center><a href='https://www.fbmessagecleaner.com/GramBot/api/paypal.php' target='_blank'>Please proceed to payment to have full access.</a></center>"}else{email="";chrome.storage.local.set({"paypalemail":""},function(){});if(confirm(responseData)==true)window.open("https://www.fbmessagecleaner.com/GramBot/api/paypal.php","_self");
else{alert("We hope that you can change your mind soon! Thank you!");deleteBtn.innerHTML="<center><a href='https://www.fbmessagecleaner.com/GramBot/api/paypal.php' target='_blank'>Please proceed to payment to have full access.</a></center>"}}}catch(err){alert("Response server issue. Please try again in 1 hour or contact support if error is persisting");mylog(err)}};var version=chrome.runtime.getManifest().version;xhttp.open("POST","https://www.fbmessagecleaner.com/GramBot/api/check.php?v="+version,
true);xhttp.setRequestHeader("Content-type","application/x-www-form-urlencoded");xhttp.setRequestHeader("Accept","application/json");xhttp.send("email="+email+"&version="+version)}
function insertProgressBtn_local(){var headerNode=document.querySelector(".logged-in");if(!headerNode)alert("Please go on instagram website homepage and make sure you are logged in.");else if(!document.getElementById(PROGRESS_SELECTED_CHAT_SUMMARIES)){deleteBtn=document.createElement("div");deleteBtn.setAttribute("id",PROGRESS_SELECTED_CHAT_SUMMARIES);deleteBtn.setAttribute("name",PROGRESS_SELECTED_CHAT_SUMMARIES);deleteBtn.setAttribute("style","text-align: center; margin-top: auto; line-height: 3em; position: fixed; top: 50%; left: 50%;    width:30em;    height:18em;    margin-top: -9em; margin-left: -15em;border: none;background-color: #4CAF50;color: white; opacity:100; visibility: visible; z-index: 100;");
deleteBtn.innerHTML="GramBot started...please wait";headerNode.appendChild(deleteBtn)}else{deleteBtn=document.getElementById(PROGRESS_SELECTED_CHAT_SUMMARIES);deleteBtn.setAttribute("style","text-align: center; margin-top: auto; line-height: 3em; position: fixed; top: 50%; left: 50%;    width:30em;    height:18em;    margin-top: -9em; margin-left: -15em;border: none;background-color: #4CAF50;color: white; opacity:100; visibility: visible; z-index: 100;");deleteBtn.innerHTML="In progress .. please wait"}}
var SetInvisible=function SetInvisible(){setTimeout(function(){var loader=document.getElementById(PROGRESS_SELECTED_CHAT_SUMMARIES);loader.style.WebkitTransition="visibility .5s, opacity .5s";loader.style.opacity="0";loader.style.visibility="hidden"},1250)};
var FinishProgressBtn=function FinishProgressBtn(){mylog("FinishProgressBtn start");if(document.getElementById(PROGRESS_SELECTED_CHAT_SUMMARIES)){var deleteBtn=document.getElementById(PROGRESS_SELECTED_CHAT_SUMMARIES);deleteBtn.innerHTML="Annonces republiees!"}SetInvisible();mylog("FinishProgressBtn done")};function sleep(milliseconds){var start=(new Date).getTime();for(var i=0;i<1E7;i++)if((new Date).getTime()-start>milliseconds)break};
